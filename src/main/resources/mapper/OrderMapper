<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- ==================代理方式=================  
由mapper标签开始，由/mapper结束，可以把它想成一个空间，是映射文件  
属性namespace：空间名，主要在代理中使用。这个namespace是唯一的。  
这里把mapper标签和接口联系在一起了，namespace=写接口路径，映射文件要和接口在同一目录下  
 -->
<mapper namespace="com.xujp.dao.OrderDao">
    <!--
    属性type:写po类的包名类名，由于之前定义了po类的别名，这里就写这个别名  
    属性id：是这个映射标签的唯一标识  
    id标签是查询结果集中的唯一标识  
    属性column：查询出来的列名  
    属性property：是po类里所指定的列名  
    通常会在原列名后面加下划线，这是固定的，这里就是id后面_
    -->
    <resultMap id="orderMapper" type="com.xujp.domain.Order">
        <result column="id" property="id"/>
        <result column="orderNo" property="orderNo"/>
        <result column="customer" property="customer"/>
        <result column="phoneNo" property="phoneNo"/>
        <result column="address" property="address"/>
        <result column="orderTime" property="orderTime"/>
        <result column="payable" property="payable"/>
        <result column="createTime" property="createTime"/>
        <result column="orderState" property="orderState"/>
    </resultMap>

    <!--sql:是sql片段标签  
    属性id是该片段的唯一标识-->
    <sql id="columnSql">
        id,orderNo,customer,phoneNo,address,orderTime,payable,createTime,orderState
    </sql>
    <!--新增订单-->
    <insert id="insertOrder" parameterType="com.xujp.domain.Order">
        INSERT int ORDER(<include refid="columnSql"/>)
        VALUES (#{id},#{orderNo},#{customer},#{phoneNo},#{address},
        #{orderTime},${payable},#{createTime},#{orderState})
    </insert>

    <!--删除订单-->
    <delete id="deleteOrder" parameterType="long">
        DELETE FROM ORDER  where id = #{id}
    </delete>

    <!--修改订单-->
    <update id="updateOrder" parameterType="com.xujp.domain.Order">
        update order set orderNo = #{orderNo},customer = #{customer},
         phoneNo = #{phoneNo},address = #{address},payable = #{payable},
         orderState = #{orderState}
         where id = #{id}
    </update>

    <!--根据Id查找订单-->
    <select id="findOrderById" parameterType="long">
        SELECT * from ORDER where id = #{id}
    </select>

    <!--模糊条件查询订单列表-->
    <select id="listOrders" resultType="com.xujp.domain.Order" parameterType="java.util.Map">
        SELECT * from ORDER
        <where>
            <if test="orderNo == null and orderNo ==  ''
                        and customer == null and customer == ''
                        and phoneNo == null and phoneNo == ''
                        and address == null and address == ''">
                and 1=1 
            </if>
            <if test="orderNo != null and orderNo != '' ">
                and orderNo LIKE '%#{orderNo}%'
            </if>
            <if test="customer != null and customer != '' ">
                and customer like '%#{customer}%'
            </if>
            <if test="phoneNo != null and phoneNo != '' ">
                and phoneNo like '%#{phoneNo}%'
            </if>
            <if test="address != null and address != '' ">
                and address like '%#{address}%'
            </if>
            <if test="payable != null and payable != '' ">
                and payable = #{payable}
            </if>
        </where>
    </select>


</mapper>